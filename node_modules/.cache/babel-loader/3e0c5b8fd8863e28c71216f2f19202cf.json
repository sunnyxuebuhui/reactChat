{"ast":null,"code":"import \"antd-mobile/lib/toast/style/css\";\nimport _Toast from \"antd-mobile/lib/toast\";\nimport _classCallCheck from \"/Users/chenyiquan/React/reactChat/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/chenyiquan/React/reactChat/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/chenyiquan/React/reactChat/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/chenyiquan/React/reactChat/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/chenyiquan/React/reactChat/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport React from 'react';\nimport axios from 'axios';\nimport { withRouter } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { actionCreators } from '../../views/login/store';\n\nvar AuthRoute =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(AuthRoute, _React$Component);\n\n  function AuthRoute() {\n    _classCallCheck(this, AuthRoute);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(AuthRoute).apply(this, arguments));\n  }\n\n  _createClass(AuthRoute, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this = this;\n\n      var publishList = ['/login', '/register'];\n      var pathname = this.props.location.pathname;\n      if (publishList.indexOf(pathname) > -1) return null;\n\n      _Toast.loading('加载中...');\n\n      axios.get('/user/info').then(function (res) {\n        _Toast.hide();\n\n        if (res.status === 200) {\n          if (res.data.code === 0) {\n            // 有登录信息\n            _this.props.getUserInfo(res.data.data);\n          } else {\n            _this.props.history.push('/login');\n          }\n        }\n      }, function (err) {\n        console.log(err);\n\n        _Toast.hide();\n\n        _Toast.info('服务异常');\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return null;\n    }\n  }]);\n\n  return AuthRoute;\n}(React.Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {};\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    getUserInfo: function getUserInfo(data) {\n      console.log(data[0]);\n      dispatch(actionCreators.getLogin(data[0]));\n    }\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(AuthRoute));","map":{"version":3,"sources":["/Users/chenyiquan/React/reactChat/src/components/authRoute/index.js"],"names":["React","axios","withRouter","connect","actionCreators","AuthRoute","publishList","pathname","props","location","indexOf","loading","get","then","res","hide","status","data","code","getUserInfo","history","push","err","console","log","info","Component","mapStateToProps","state","mapDispatchToProps","dispatch","getLogin"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,UAAT,QAA2B,kBAA3B;AAEA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,cAAT,QAA+B,yBAA/B;;IAEMC,S;;;;;;;;;;;;;wCACgB;AAAA;;AAClB,UAAMC,WAAW,GAAG,CAAC,QAAD,EAAW,WAAX,CAApB;AACA,UAAMC,QAAQ,GAAG,KAAKC,KAAL,CAAWC,QAAX,CAAoBF,QAArC;AACA,UAAID,WAAW,CAACI,OAAZ,CAAoBH,QAApB,IAAgC,CAAC,CAArC,EAAwC,OAAO,IAAP;;AAExC,aAAMI,OAAN,CAAc,QAAd;;AACAV,MAAAA,KAAK,CAACW,GAAN,CAAU,YAAV,EAAwBC,IAAxB,CAA6B,UAAAC,GAAG,EAAI;AAClC,eAAMC,IAAN;;AACA,YAAGD,GAAG,CAACE,MAAJ,KAAe,GAAlB,EAAuB;AACrB,cAAIF,GAAG,CAACG,IAAJ,CAASC,IAAT,KAAkB,CAAtB,EAAyB;AACvB;AACA,YAAA,KAAI,CAACV,KAAL,CAAWW,WAAX,CAAuBL,GAAG,CAACG,IAAJ,CAASA,IAAhC;AACD,WAHD,MAGO;AACL,YAAA,KAAI,CAACT,KAAL,CAAWY,OAAX,CAAmBC,IAAnB,CAAwB,QAAxB;AACD;AACF;AACF,OAVD,EAUG,UAAAC,GAAG,EAAI;AACRC,QAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;;AACA,eAAMP,IAAN;;AACA,eAAMU,IAAN,CAAW,MAAX;AACD,OAdD;AAeD;;;6BAEQ;AACP,aAAO,IAAP;AACD;;;;EA1BqBzB,KAAK,CAAC0B,S;;AA6B9B,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAACC,KAAD,EAAW;AACjC,SAAO,EAAP;AAED,CAHD;;AAKA,IAAMC,kBAAkB,GAAG,SAArBA,kBAAqB,CAACC,QAAD,EAAc;AACvC,SAAO;AACLX,IAAAA,WADK,uBACOF,IADP,EACa;AAChBM,MAAAA,OAAO,CAACC,GAAR,CAAYP,IAAI,CAAC,CAAD,CAAhB;AACAa,MAAAA,QAAQ,CAAC1B,cAAc,CAAC2B,QAAf,CAAwBd,IAAI,CAAC,CAAD,CAA5B,CAAD,CAAR;AACD;AAJI,GAAP;AAMD,CAPD;;AASA,eAAef,UAAU,CAACC,OAAO,CAACwB,eAAD,EAAkBE,kBAAlB,CAAP,CAA6CxB,SAA7C,CAAD,CAAzB","sourcesContent":["import React from 'react'\nimport axios from 'axios'\nimport { withRouter } from 'react-router-dom'\nimport { Toast } from 'antd-mobile'\nimport { connect } from 'react-redux'\nimport { actionCreators } from '../../views/login/store'\n\nclass AuthRoute extends React.Component {\n  componentDidMount() {\n    const publishList = ['/login', '/register']\n    const pathname = this.props.location.pathname\n    if (publishList.indexOf(pathname) > -1) return null\n\n    Toast.loading('加载中...');\n    axios.get('/user/info').then(res => {\n      Toast.hide();\n      if(res.status === 200) {\n        if (res.data.code === 0) {\n          // 有登录信息\n          this.props.getUserInfo(res.data.data)\n        } else {\n          this.props.history.push('/login')\n        }\n      }\n    }, err => {\n      console.log(err)\n      Toast.hide()\n      Toast.info('服务异常') \n    })\n  }\n\n  render() {\n    return null\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n  }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    getUserInfo(data) {\n      console.log(data[0])\n      dispatch(actionCreators.getLogin(data[0]))\n    }\n  }\n}\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(AuthRoute))"]},"metadata":{},"sourceType":"module"}