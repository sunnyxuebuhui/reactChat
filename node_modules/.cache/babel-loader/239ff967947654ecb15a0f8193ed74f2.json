{"ast":null,"code":"import axios from 'axios';\nimport io from 'socket.io-client';\nvar socket = io('ws://localhost:9093'); // 获取聊天列表\n\nvar MSG_LIST = 'MSG_LIST'; // 读取信息\n\nvar MSG_RECV = 'MSG_RECV'; // 标识已读\n\nvar MSG_READ = 'MSG_READ';\nvar initState = {\n  chatmsg: [],\n  users: {},\n  unread: 0\n  /**\n   * 获取聊天信息列表\n   */\n\n};\nexport function getMsgList() {\n  return function (dispatch, getState) {\n    axios.get('/user/getMsgList').then(function (res) {\n      if (res.status === 200 && res.data.code === 0) {\n        var userid = getState().user._id;\n\n        dispatch(msgList(res.data.msgs, res.data.users, userid));\n      }\n    });\n  };\n}\n\nfunction msgList(msgs, users, userid) {\n  return {\n    type: MSG_LIST,\n    payload: {\n      msgs: msgs,\n      users: users,\n      userid: userid\n    }\n  };\n}\n/**\n * 发送聊天信息\n * 实时双向通信\n */\n\n\nexport function sendMsg(_ref) {\n  var from = _ref.from,\n      to = _ref.to,\n      msg = _ref.msg;\n  return function (dispatch) {\n    socket.emit('sendmsg', {\n      from: from,\n      to: to,\n      msg: msg\n    });\n  };\n}\n/**\n * 接受聊天信息\n * 实时双向通信\n */","map":{"version":3,"sources":["/Users/chenyiquan/React/reactChat/src/views/bossInfo/store/reducer.js"],"names":["axios","io","socket","MSG_LIST","MSG_RECV","MSG_READ","initState","chatmsg","users","unread","getMsgList","dispatch","getState","get","then","res","status","data","code","userid","user","_id","msgList","msgs","type","payload","sendMsg","from","to","msg","emit"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,EAAP,MAAe,kBAAf;AAEA,IAAMC,MAAM,GAAGD,EAAE,CAAC,qBAAD,CAAjB,C,CAEA;;AACA,IAAME,QAAQ,GAAG,UAAjB,C,CACA;;AACA,IAAMC,QAAQ,GAAG,UAAjB,C,CACA;;AACA,IAAMC,QAAQ,GAAG,UAAjB;AAEA,IAAMC,SAAS,GAAG;AAChBC,EAAAA,OAAO,EAAE,EADO;AAEhBC,EAAAA,KAAK,EAAE,EAFS;AAGhBC,EAAAA,MAAM,EAAE;AAGV;;;;AANkB,CAAlB;AASA,OAAO,SAASC,UAAT,GAAsB;AAC3B,SAAO,UAACC,QAAD,EAAWC,QAAX,EAAwB;AAC7BZ,IAAAA,KAAK,CAACa,GAAN,CAAU,kBAAV,EACGC,IADH,CACQ,UAAAC,GAAG,EAAI;AACX,UAAIA,GAAG,CAACC,MAAJ,KAAe,GAAf,IAAsBD,GAAG,CAACE,IAAJ,CAASC,IAAT,KAAkB,CAA5C,EAA+C;AAC7C,YAAMC,MAAM,GAAGP,QAAQ,GAAGQ,IAAX,CAAgBC,GAA/B;;AACAV,QAAAA,QAAQ,CAACW,OAAO,CAACP,GAAG,CAACE,IAAJ,CAASM,IAAV,EAAgBR,GAAG,CAACE,IAAJ,CAAST,KAAzB,EAAgCW,MAAhC,CAAR,CAAR;AACD;AACF,KANH;AAOD,GARD;AASD;;AACD,SAASG,OAAT,CAAiBC,IAAjB,EAAuBf,KAAvB,EAA8BW,MAA9B,EAAsC;AACpC,SAAO;AACLK,IAAAA,IAAI,EAAErB,QADD;AAELsB,IAAAA,OAAO,EAAE;AAACF,MAAAA,IAAI,EAAJA,IAAD;AAAOf,MAAAA,KAAK,EAALA,KAAP;AAAcW,MAAAA,MAAM,EAANA;AAAd;AAFJ,GAAP;AAID;AAED;;;;;;AAIA,OAAO,SAASO,OAAT,OAAkC;AAAA,MAAhBC,IAAgB,QAAhBA,IAAgB;AAAA,MAAVC,EAAU,QAAVA,EAAU;AAAA,MAANC,GAAM,QAANA,GAAM;AACvC,SAAO,UAAAlB,QAAQ,EAAI;AACjBT,IAAAA,MAAM,CAAC4B,IAAP,CAAY,SAAZ,EAAuB;AAACH,MAAAA,IAAI,EAAJA,IAAD;AAAOC,MAAAA,EAAE,EAAFA,EAAP;AAAWC,MAAAA,GAAG,EAAHA;AAAX,KAAvB;AACD,GAFD;AAGD;AAED","sourcesContent":["import axios from 'axios'\nimport io from 'socket.io-client'\n\nconst socket = io('ws://localhost:9093')\n\n// 获取聊天列表\nconst MSG_LIST = 'MSG_LIST'\n// 读取信息\nconst MSG_RECV = 'MSG_RECV'\n// 标识已读\nconst MSG_READ = 'MSG_READ'\n\nconst initState = {\n  chatmsg: [],\n  users: {},\n  unread: 0\n}\n\n/**\n * 获取聊天信息列表\n */\nexport function getMsgList() {\n  return (dispatch, getState) => {\n    axios.get('/user/getMsgList')\n      .then(res => {\n        if (res.status === 200 && res.data.code === 0) {\n          const userid = getState().user._id\n          dispatch(msgList(res.data.msgs, res.data.users, userid))\n        }\n      })\n  }\n}\nfunction msgList(msgs, users, userid) {\n  return {\n    type: MSG_LIST,\n    payload: {msgs, users, userid}\n  }\n}\n\n/**\n * 发送聊天信息\n * 实时双向通信\n */\nexport function sendMsg({from, to, msg}) {\n  return dispatch => {\n    socket.emit('sendmsg', {from, to, msg})\n  }\n}\n\n/**\n * 接受聊天信息\n * 实时双向通信\n */\n\n\n\n\n\n"]},"metadata":{},"sourceType":"module"}